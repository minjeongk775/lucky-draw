async function selectWinner() {
    try {
        // 랜덤성 강화
        const shuffleArray = (array) => {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
            return array;
        };

        // 참가자 목록을 배열로 변환 후 섞기
        const participantArray = Object.entries(participants);
        const shuffledParticipants = shuffleArray(participantArray);
        
        // 현재 시간을 시드로 사용하여 추가 랜덤성 부여
        const seed = Date.now() % shuffledParticipants.length;
        const winnerIndex = Math.floor(Math.random() * seed * Math.random() * shuffledParticipants.length);
        const [winnerKey, winner] = shuffledParticipants[winnerIndex % shuffledParticipants.length];

        const winnerDisplay = document.getElementById('winner-display');
        winnerDisplay.innerHTML = `
            <div class="winner-title">🎉 축하합니다! 🎉</div>
            <div class="winner-name">${winner.name}</div>
            <div class="winner-id">${winner.empId}</div>
        `;

        createConfetti();

        await database.ref(`participants/${winnerKey}`).remove();
        isDrawing = false;

    } catch (error) {
        console.error('Error in selectWinner:', error);
        alert('당첨자 선정 중 오류가 발생했습니다.');
        isDrawing = false;
    }
}
